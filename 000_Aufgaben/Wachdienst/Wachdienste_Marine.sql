-- CREATE DATABASE db_ef2;

DROP TABLE IF EXISTS wachdienst CASCADE;
DROP TABLE IF EXISTS soldat CASCADE;
DROP TABLE IF EXISTS schiff CASCADE;
DROP TABLE IF EXISTS geschwader CASCADE;
DROP TABLE IF EXISTS dienstgrad CASCADE;

CREATE TABLE IF NOT EXISTS dienstgrad
(
    dienstgradid INTEGER GENERATED BY DEFAULT AS IDENTITY,
    dg_liste     TEXT NOT NULL,
    dg_kurz      TEXT NOT NULL,
    dg_lang      TEXT NOT NULL,
    stundensatz  DECIMAL(10, 2),
    PRIMARY KEY (dienstgradid),
    CONSTRAINT check_pos_satz CHECK (stundensatz >= 0)
);

INSERT INTO dienstgrad (dienstgradid, dg_liste, dg_kurz, dg_lang, stundensatz)
VALUES (100, 'S', 'Matr', 'Matrose', 14.50),
       (200, 'G', 'Gefr', 'Gefreiter', 15.00),
       (300, 'OG', 'OGefr', 'Obergefreiter', 15.50),
       (400, 'HG', 'HptGefr', 'Hauptgefreiter', 16.20),
       (500, 'SG', 'StGefr', 'Stabsgefreiter', 16.80),
       (600, 'OSG', 'OStGefr', 'Oberstabsgefreiter', 17.50),
       (700, 'K', 'Korp', 'Korporal', 18.00),
       (800, 'SK', 'StKorp', 'Stabskorporal', 18.50),
       (900, 'MT', 'Maat', 'Maat', 19.50),
       (1000, 'OMT', 'OMaat', 'Obermaat', 20.50),
       (1100, 'SKAD', 'SKad', 'Seekadett', 15.00),
       (1200, 'B', 'Btsm', 'Bootsmann', 22.00),
       (1300, 'FRZS', 'Faehnr zS', 'Faehnrich zur See', 17.00),
       (1400, 'OB', 'OBtsm', 'Oberbootsmann', 23.50),
       (1500, 'HB', 'HptBtsm', 'Hauptbootsmann', 25.00),
       (1600, 'OFRZS', 'OFaehnr zS', 'Oberfaehnrich zur See', 19.00),
       (1700, 'SB', 'StBtsm', 'Stabsbootsmann', 27.00),
       (1800, 'OSB', 'OStBtsm', 'Oberstabsbootsmann', 29.50),
       (1900, 'LZS', 'Lt zS', 'Leutnant zur See', 31.00),
       (2000, 'OLZS', 'OLt zS', 'Oberleutnant zur See', 34.50),
       (2100, 'KL', 'KptLt', 'Kapitaenleutnant', 39.00),
       (2200, 'SKL', 'StKptLt', 'Stabskapitaenleutnant', 42.50),
       (2300, 'KK', 'KKpt', 'Korvettenkapitaen', 45.00),
       (2400, 'FK', 'FKpt', 'Fregattenkapitaen', 52.00),
       (2500, 'KZS', 'Kpt zS', 'Kapitaen zur See', 60.00),
       (2600, 'FADM', 'FltlAdm', 'Flottillenadmiral', 75.00),
       (2700, 'KADM', 'KAdm', 'Konteradmiral', 85.00),
       (2800, 'VADM', 'VAdm', 'Vizeadmiral', 98.00),
       (2900, 'ADM', 'Adm', 'Admiral', 115.00);

CREATE TABLE geschwader
(
    geschwaderid  INT,
    name          TEXT NOT NULL,
    standort      TEXT,
    unterstellung TEXT,
    PRIMARY KEY (geschwaderid)
);

INSERT INTO geschwader (geschwaderid, name, standort, unterstellung)
VALUES (2, '2. Fregattengeschwader', 'Wilhelmshaven', 'Einsatzflottille 2'),
       (4, '4. Fregattengeschwader', 'Wilhelmshaven', 'Einsatzflottille 2'),
       (10, 'Trossgeschwader', 'Wilhelmshaven/Kiel', 'Einsatzflottille 2');

CREATE TABLE schiff
(
    schiffid     INT,
    hullnumber   TEXT NOT NULL UNIQUE,
    schiffsname  TEXT NOT NULL,
    klasse       TEXT NOT NULL,
    geschwaderid INT,
    PRIMARY KEY (schiffid),
    FOREIGN KEY (geschwaderid) REFERENCES geschwader (geschwaderid),
    CONSTRAINT check_hull_len CHECK (length(hullnumber) >= 4)
);

INSERT INTO schiff (schiffid, hullnumber, schiffsname, klasse, geschwaderid)
VALUES (215, 'F215', 'FGS Brandenburg', 'F123', 2),
       (216, 'F216', 'FGS Schleswig-Holstein', 'F123', 2),
       (217, 'F217', 'FGS Bayern', 'F123', 2),
       (218, 'F218', 'FGS Mecklenburg-Vorpommern', 'F123', 2),
       (219, 'F219', 'FGS Sachsen', 'F124', 2),
       (220, 'F220', 'FGS Hamburg', 'F124', 2),
       (221, 'F221', 'FGS Hessen', 'F124', 2),
       (222, 'F222', 'FGS Baden-Württemberg', 'F125', 4),
       (223, 'F223', 'FGS Nordrhein-Westfalen', 'F125', 4),
       (224, 'F224', 'FGS Sachsen-Anhalt', 'F125', 4),
       (225, 'F225', 'FGS Rheinland-Pfalz', 'F125', 4),
       (1411, 'A1411', 'FGS Berlin', '702', 10),
       (1412, 'A1412', 'FGS Frankfurt am Main', '702', 10),
       (1413, 'A1413', 'FGS Bonn', '702', 10);

CREATE TABLE soldat
(
    persnr        INT GENERATED BY DEFAULT AS IDENTITY,
    vorname       TEXT,
    name          TEXT NOT NULL,
    dienstgradid  INT,
    stammschiffid INT,
    PRIMARY KEY (persnr),
    FOREIGN KEY (dienstgradid) REFERENCES dienstgrad (dienstgradid),
    FOREIGN KEY (stammschiffid) REFERENCES schiff (schiffid)
);

INSERT INTO soldat (persnr, vorname, name, dienstgradid, stammschiffid)
VALUES
-- =======================================================
-- KLASSE F123 (Brandenburg-Klasse)
-- =======================================================

-- FGS Brandenburg (ID 215)
(10001, 'Thomas', 'Müller', 2400, 215),
(10002, 'Andreas', 'Schneider', 2100, 215),
(10003, 'Lukas', 'Wagner', 2000, 215),
(10004, 'Michael', 'Fischer', 1500, 215),
(10005, 'Stefan', 'Weber', 1200, 215),
(10006, 'Kevin', 'Meyer', 900, 215),
(10007, 'Jan', 'Schulz', 400, 215),
(10008, 'Tim', 'Becker', 400, 215),
(10009, 'Dennis', 'Hoffmann', 300, 215),
(10010, 'Patrick', 'Koch', 200, 215),
(10011, 'Sven', 'Richter', 200, 215),
(10012, 'Nils', 'Bauer', 100, 215),

-- FGS Schleswig-Holstein (ID 216)
(10021, 'Martin', 'Klein', 2400, 216),
(10022, 'Christian', 'Wolf', 2100, 216),
(10023, 'Kai', 'Schröder', 2000, 216),
(10024, 'Uwe', 'Neumann', 1700, 216),
(10025, 'Jörg', 'Schwarz', 1400, 216),
(10026, 'Tobias', 'Zimmermann', 1000, 216),
(10027, 'Philipp', 'Braun', 500, 216),
(10028, 'Marcel', 'Krüger', 400, 216),
(10029, 'Felix', 'Hofmann', 300, 216),
(10030, 'Simon', 'Hartmann', 200, 216),
(10031, 'Julian', 'Lange', 200, 216),
(10032, 'Florian', 'Schmitt', 100, 216),

-- FGS Bayern (ID 217)
(10041, 'Peter', 'Werner', 2400, 217),
(10042, 'Markus', 'Schmitz', 2100, 217),
(10043, 'Jens', 'Krause', 1900, 217),
(10044, 'Alexander', 'Meier', 1500, 217),
(10045, 'Daniel', 'Lehmann', 1200, 217),
(10046, 'Marco', 'Schmid', 900, 217),
(10047, 'David', 'Schulze', 400, 217),
(10048, 'Max', 'Maier', 400, 217),
(10049, 'Erik', 'Köhler', 300, 217),
(10050, 'Tom', 'Herrmann', 200, 217),
(10051, 'Paul', 'König', 200, 217),
(10052, 'Hendrik', 'Walter', 100, 217),

-- FGS Mecklenburg-Vorpommern (ID 218)
(10061, 'Robert', 'Mayer', 2400, 218),
(10062, 'Frank', 'Huber', 2100, 218),
(10063, 'Hannes', 'Kaiser', 2000, 218),
(10064, 'Gerd', 'Fuchs', 1700, 218),
(10065, 'Sascha', 'Peters', 1200, 218),
(10066, 'René', 'Lang', 900, 218),
(10067, 'Dominik', 'Scholz', 500, 218),
(10068, 'Timo', 'Möller', 400, 218),
(10069, 'Robin', 'Weiß', 300, 218),
(10070, 'Nico', 'Jung', 200, 218),
(10071, 'Fabian', 'Hahn', 200, 218),
(10072, 'Sebastian', 'Keller', 100, 218),

-- =======================================================
-- KLASSE F124 (Sachsen-Klasse)
-- =======================================================

-- FGS Sachsen (ID 219)
(10081, 'Torsten', 'Vogel', 2400, 219),
(10082, 'Matthias', 'Friedrich', 2100, 219),
(10083, 'Lars', 'Günther', 1900, 219),
(10084, 'Dirk', 'Schubert', 1500, 219),
(10085, 'Heiko', 'Berger', 1400, 219),
(10086, 'Maik', 'Winkler', 1000, 219),
(10087, 'Oliver', 'Roth', 400, 219),
(10088, 'Niklas', 'Frank', 400, 219),
(10089, 'Jonas', 'Beck', 300, 219),
(10090, 'Finn', 'Lorenz', 200, 219),
(10091, 'Leon', 'Baumann', 200, 219),
(10092, 'Luca', 'Böhm', 100, 219),

-- FGS Hamburg (ID 220)
(10101, 'Jürgen', 'Albrecht', 2400, 220),
(10102, 'Ralf', 'Ludwig', 2100, 220),
(10103, 'Christoph', 'Jäger', 2000, 220),
(10104, 'Bernd', 'Kraus', 1700, 220),
(10105, 'Carsten', 'Schulte', 1200, 220),
(10106, 'Ingo', 'Haas', 900, 220),
(10107, 'Moritz', 'Graf', 500, 220),
(10108, 'Benjamin', 'Simon', 400, 220),
(10109, 'Jakob', 'Förster', 300, 220),
(10110, 'Elias', 'Sauer', 200, 220),
(10111, 'Noah', 'Arnold', 200, 220),
(10112, 'Henry', 'Winter', 100, 220),

-- FGS Hessen (ID 221)
(10121, 'Holger', 'Seidel', 2400, 221),
(10122, 'Björn', 'Heinrich', 2100, 221),
(10123, 'Arne', 'Brandt', 1900, 221),
(10124, 'Mario', 'Schreiber', 1500, 221),
(10125, 'Steffen', 'Otto', 1400, 221),
(10126, 'Karsten', 'Dietrich', 1000, 221),
(10127, 'Manuel', 'Stein', 400, 221),
(10128, 'Pascal', 'Ludwig', 400, 221),
(10129, 'Sören', 'Gärtner', 300, 221),
(10130, 'Malte', 'Jakob', 200, 221),
(10131, 'Ole', 'Engel', 200, 221),
(10132, 'Fiete', 'Kuhn', 100, 221),

-- =======================================================
-- KLASSE F125 (Baden-Württemberg-Klasse)
-- =======================================================

-- FGS Baden-Württemberg (ID 222)
(10141, 'Klaus', 'Pohl', 2400, 222),
(10142, 'Dieter', 'Wolff', 2200, 222),
(10143, 'Volker', 'Thomas', 2100, 222),
(10144, 'Wolfgang', 'Ernst', 1800, 222),
(10145, 'Reinhard', 'Busch', 1500, 222),
(10146, 'Gunther', 'Horn', 1200, 222),
(10147, 'Timon', 'Arnold', 700, 222),
(10148, 'Lennart', 'Hübner', 800, 222),
(10149, 'Bastian', 'Voigt', 400, 222),
(10150, 'Adrian', 'Seifert', 300, 222),
(10151, 'Christopher', 'Ullrich', 200, 222),
(10152, 'Dustin', 'Kramer', 100, 222),

-- FGS Nordrhein-Westfalen (ID 223)
(10161, 'Joachim', 'Franz', 2400, 223),
(10162, 'Gerrit', 'Peter', 2100, 223),
(10163, 'Thilo', 'Stark', 2000, 223),
(10164, 'Rüdiger', 'Menzel', 1700, 223),
(10165, 'Harald', 'Beyer', 1400, 223),
(10166, 'Marius', 'Kuntz', 900, 223),
(10167, 'Silas', 'Witt', 700, 223),
(10168, 'Benedikt', 'Reuter', 400, 223),
(10169, 'Justus', 'Hess', 300, 223),
(10170, 'Milan', 'Blum', 200, 223),
(10171, 'Emil', 'Kästner', 200, 223),
(10172, 'Anton', 'Binder', 100, 223),

-- FGS Sachsen-Anhalt (ID 224)
(10181, 'Erich', 'Körner', 2400, 224),
(10182, 'Lothar', 'Popp', 2200, 224),
(10183, 'Falk', 'Unger', 1900, 224),
(10184, 'Detlef', 'Franke', 1500, 224),
(10185, 'Andre', 'Rieder', 1200, 224),
(10186, 'Mirko', 'Bock', 1000, 224),
(10187, 'Hauke', 'Wenzel', 400, 224),
(10188, 'Kalle', 'Fiedler', 400, 224),
(10189, 'Piet', 'Ebers', 300, 224),
(10190, 'Michel', 'Hinz', 200, 224),
(10191, 'Luis', 'Frey', 200, 224),
(10192, 'Hanno', 'Junker', 100, 224),

-- FGS Rheinland-Pfalz (ID 225)
(10201, 'Walter', 'Urban', 2400, 225),
(10202, 'Udo', 'Wegner', 2100, 225),
(10203, 'Sven', 'Schindler', 2000, 225),
(10204, 'Hagen', 'Sander', 1700, 225),
(10205, 'Bodo', 'Adler', 1400, 225),
(10206, 'Till', 'Schramm', 900, 225),
(10207, 'Lasse', 'Mai', 700, 225),
(10208, 'Mattes', 'Hein', 500, 225),
(10209, 'Jannes', 'Fricke', 400, 225),
(10210, 'Bjarne', 'Nickel', 300, 225),
(10211, 'Tjark', 'Reimann', 200, 225),
(10212, 'Helge', 'Wetzel', 100, 225),

-- ==========================================================
-- KLASSE 702 (Berlin-Klasse)
-- ==========================================================

-- FGS BERLIN (A1411)
(20001, 'Christian', 'Arndt', 2400, 1411),
(20002, 'Stefan', 'Brand', 2100, 1411),
(20003, 'Michael', 'Conrad', 2100, 1411),
(20004, 'Thomas', 'Decker', 1400, 1411),
(20005, 'Andreas', 'Engel', 1200, 1411),
(20006, 'Peter', 'Franke', 1200, 1411),
(20007, 'Kevin', 'Götz', 400, 1411),
(20008, 'Daniel', 'Held', 400, 1411),
(20009, 'Marcel', 'Immel', 400, 1411),
(20010, 'Jonas', 'Jahn', 200, 1411),
(20011, 'Lukas', 'Kurz', 200, 1411),
(20012, 'Jan', 'Lenz', 100, 1411),
(20013, 'Tim', 'Moos', 100, 1411),

-- FGS FRANKFURT AM MAIN (A1412)
(20101, 'Markus', 'Noll', 2400, 1412),
(20102, 'Tobias', 'Ott', 2100, 1412),
(20103, 'Alexander', 'Pohl', 1400, 1412),
(20104, 'Sebastian', 'Querner', 1400, 1412),
(20105, 'Martin', 'Rahn', 1200, 1412),
(20106, 'Dominik', 'Stark', 400, 1412),
(20107, 'Patrick', 'Thiele', 400, 1412),
(20108, 'Fabian', 'Ulbricht', 400, 1412),
(20109, 'Nico', 'Vogel', 200, 1412),
(20110, 'Dennis', 'Witt', 200, 1412),
(20111, 'Florian', 'Xylander', 100, 1412),
(20112, 'Erik', 'York', 100, 1412),

-- FGS BONN (A1413)
(20201, 'Robert', 'Zander', 2400, 1413),
(20202, 'Jens', 'Acker', 2100, 1413),
(20203, 'Uwe', 'Baier', 1400, 1413),
(20204, 'Frank', 'Christ', 1200, 1413),
(20205, 'Heiko', 'Dorn', 1200, 1413),
(20206, 'Sven', 'Ebert', 400, 1413),
(20207, 'Marco', 'Funk', 400, 1413),
(20208, 'Thorsten', 'Gross', 400, 1413),
(20209, 'Philipp', 'Horn', 200, 1413),
(20210, 'Simon', 'Iltis', 200, 1413),
(20211, 'Julian', 'Just', 100, 1413);

CREATE TABLE wachdienst
(
    wachid         INT PRIMARY KEY,
    soldatid       INT,
    schiffid       INT,
    startzeit      TIMESTAMP NOT NULL,
    endezeit       TIMESTAMP NOT NULL,
    risikozuschlag DECIMAL(10, 2) DEFAULT 0.00,
    FOREIGN KEY (soldatid) REFERENCES soldat (persnr),
    FOREIGN KEY (schiffid) REFERENCES schiff (schiffid),
    CONSTRAINT check_zeit_logik CHECK (endezeit > startzeit),
    CONSTRAINT check_pos_risiko CHECK (risikozuschlag >= 0)
);
INSERT INTO wachdienst (wachid, soldatid, schiffid, startzeit, endezeit, risikozuschlag)
VALUES

-- =======================================================
-- F123 (Brandenburg-Klasse) - Standardwachen
-- =======================================================
-- HptGefr Schulz (10007) macht eine normale 4-Stunden-Wache
(1, 10007, 215, '2023-11-01 08:00:00', '2023-11-01 12:00:00', 0.00),

-- Matrose Bauer (10012) - Schicht 1 (4 Std)
(2, 10012, 215, '2023-11-01 12:00:00', '2023-11-01 16:00:00', 10.00),
-- Matrose Bauer (10012) - Schicht 2 (5 Std) -> Damit kommt er über 8 Std für HAVING!
(3, 10012, 215, '2023-11-02 08:00:00', '2023-11-02 13:00:00', 10.00),

-- KptLt Wolf (10022) ist eigentlich auf Schiff 216, hilft aber auf 217 (Bayern) aus
(4, 10022, 217, '2023-11-01 22:00:00', '2023-11-02 02:00:00', 25.00),

-- HptGefr Maier (10048) auf der Bayern
(5, 10048, 217, '2023-11-03 14:00:00', '2023-11-03 18:00:00', 0.00),

-- =======================================================
-- F124 (Sachsen-Klasse) - Gefechtsübungen (Hohes Risiko)
-- =======================================================
-- FKpt Vogel (10081) - Der Kommandant auf der Brücke während Übung
(6, 10081, 219, '2023-11-05 09:00:00', '2023-11-05 11:00:00', 100.00),

-- HptGefr Roth (10087) - Lange Wache während Übung
(7, 10087, 219, '2023-11-05 08:00:00', '2023-11-05 16:00:00', 50.00),

-- OGefr Beck (10089)
(8, 10089, 219, '2023-11-05 16:00:00', '2023-11-05 20:00:00', 50.00),

-- StGefr Graf (10107) auf FGS Hamburg
(9, 10107, 220, '2023-11-06 00:00:00', '2023-11-06 04:00:00', 30.00),

-- HptBtsm Schreiber (10124) auf FGS Hessen - Maschinenraumwache
(10, 10124, 221, '2023-11-06 08:00:00', '2023-11-06 14:00:00', 15.00),

-- =======================================================
-- F125 (Baden-Württemberg) - Stabilisierungseinsatz
-- =======================================================
-- Korporal Arnold (10147) - Neue Laufbahn im Einsatz
(11, 10147, 222, '2023-11-10 10:00:00', '2023-11-10 18:00:00', 0.00),

-- StKptLt Wolff (10142) - Fachoffizier Wache
(12, 10142, 222, '2023-11-10 18:00:00', '2023-11-10 20:00:00', 0.00),

-- Maat Kuntz (10166) auf NRW
(13, 10166, 223, '2023-11-11 04:00:00', '2023-11-11 08:00:00', 20.00),

-- HptGefr Reuter (10168) auf NRW
(14, 10168, 223, '2023-11-11 08:00:00', '2023-11-11 12:00:00', 20.00),

-- StKptLt Popp (10182) auf Sachsen-Anhalt
(15, 10182, 224, '2023-11-12 12:00:00', '2023-11-12 14:00:00', 0.00),

-- Gefr Reimann (10211) auf Rheinland-Pfalz
(16, 10211, 225, '2023-11-13 22:00:00', '2023-11-14 06:00:00', 40.00),

-- ==========================================================
-- EGV BERLIN (Manöver: Versorgung auf See mit Fregatte Hamburg)
-- ==========================================================
-- KptLt Brand koordiniert die Betankung (Hohe Verantwortung, Risiko)
(100, 20002, 1411, '2023-11-15 10:00:00', '2023-11-15 14:00:00', 45.00),

-- OBtsm Decker überwacht das Schlauchmanöver an Deck (Gefährlich!)
(101, 20004, 1411, '2023-11-15 10:00:00', '2023-11-15 14:00:00', 60.00),

-- HG Götz und Held sichern die Ladung (Normaler Dienst)
(102, 20007, 1411, '2023-11-15 08:00:00', '2023-11-15 12:00:00', 0.00),
(103, 20008, 1411, '2023-11-15 12:00:00', '2023-11-15 16:00:00', 0.00),

-- ==========================================================
-- EGV FRANKFURT AM MAIN (Nachtfahrt / Überführung)
-- ==========================================================
-- FKpt Noll hat die Brücke bei schwieriger Passage
(104, 20101, 1412, '2023-11-16 02:00:00', '2023-11-16 06:00:00', 20.00),

-- Gefr Vogel hält Ausguck (Nachtzuschlag simuliert durch Risiko)
(105, 20109, 1412, '2023-11-16 00:00:00', '2023-11-16 04:00:00', 15.00),

-- Gefr Witt löst ab
(106, 20110, 1412, '2023-11-16 04:00:00', '2023-11-16 08:00:00', 15.00),

-- ==========================================================
-- EGV BONN (Hafenliegezeit & Sanitätsübung)
-- ==========================================================
-- Btsm Christ macht die Gangway-Wache im Hafen (Standard)
(107, 20204, 1413, '2023-11-17 08:00:00', '2023-11-17 18:00:00', 0.00),

-- Matr Just hilft bei einer Sanitätsübung im Bordhospital (Kein echtes Risiko)
(108, 20211, 1413, '2023-11-17 09:00:00', '2023-11-17 12:00:00', 0.00),

-- HG Ebert macht lange Nachtwache (Dauerläufer für Aufgabe 4/7!)
(109, 20206, 1413, '2023-11-18 20:00:00', '2023-11-19 06:00:00', 10.00);